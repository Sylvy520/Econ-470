<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Section 3: Hospital Pricing and Selection on Observables</title>
    <meta charset="utf-8" />
    <meta name="author" content="Ian McCarthy | Emory University" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Section 3: Hospital Pricing and Selection on Observables
## <html>
<div style="float:left">

</div>
<hr color='#EB811B' size=1px width=1050px>
</html>
### Ian McCarthy | Emory University
### Econ 470 &amp; HLTH 470

---


&lt;!-- Adjust some CSS code for font size and maintain R code font size --&gt;
&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 30px;
    padding: 1em 2em 1em 2em;    
}
.remark-code {
  font-size: 15px;
}
.remark-inline-code { 
    font-size: 20px;
}
&lt;/style&gt;


&lt;!-- Set R options for how code chunks are displayed and load packages --&gt;


# Table of contents

1. [Hospital Pricing](#hospital_pricing)

2. [Potential Outcomes Framework](#potential_outcomes)

3. [Selection on Observables](#selection_observables)

4. [Methods](#methods)

5. [HCRIS Data](#hcris)

6. [Pricing and Pay for Performance](#price_pfp)

&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: hospital_pricing

# Background on Hospital Pricing

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

---
# What is a hospital price?

Defining characteristic of hospital services: *it's complicated!*

--
.center[
  ![:scale 800px](pics/BillExample.jpg)
]

&lt;div class="smalltext"&gt;Brill, Steven. 2013. "Bitter Pill: Why Medical Bills are Killing Us." *Time Magazine*.&lt;/div&gt;

---
# What is a hospital price?

Lots of different payers paying lots of different prices:
- [Medicare fee-for-service prices](https://www.cms.gov/Outreach-and-Education/Medicare-Learning-Network-MLN/MLNProducts/Downloads/AcutePaymtSysfctsht.pdf)
- [Medicaid payments](https://www.kff.org/report-section/understanding-medicaid-hospital-payments-and-the-impact-of-recent-policy-changes-issue-brief/)
- Private insurance negotiations (including Medicare Advantage)
- But what about the price to patients?

--

.center[
Price `\(\neq\)` charge `\(\neq\)` cost `\(\neq\)` patient out-of-pocket spending
]

---
# What is a hospital price?

.center[
  ![:scale 600px](pics/DifferentPrices.jpg)
]

&lt;div class="smalltext"&gt;Source: &lt;a href="https://healthcarepricingproject.org/"&gt;Health Care Pricing Project&lt;/a&gt;&lt;/div&gt;


---
# What is a hospital price?
Not clear what exactly is negotiated...

--
.pull-left[
### Fee-for-service
- price per procedure
- percentage of charges
- markup over Medicare rates
]

--
.pull-right[
### Capitation
- payment per patient &lt;/br&gt;
  `\(+\)` pay-for-performance &lt;/br&gt;
  `\(+\)` shared savings
]

---
# Hospital prices in real life
We'll get into the real data in a bit, but for now...a few facts:

1. Hospital services are expensive
2. Prices vary dramatically across different areas
3. Lack of competition is a major reason for high prices

---
# Hospital prices in real life

.pull-left[
  ![:scale 450px](pics/HC_var_withinmkt_hip_ga_atlanta.png)
]

.pull-right[
  ![:scale 450px](pics/HC_var_withinmkt_kmri_ga_atlanta.png)
]

&lt;div class="smalltext"&gt;Source: &lt;a href="https://healthcarepricingproject.org/"&gt;Health Care Pricing Project&lt;/a&gt;&lt;/div&gt;



&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: potential_outcomes

# Potential Outcomes Framework

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;


---
# What is a "Potential Outcome"
.pull-left[
![:scale 420px](pics/EmoryPicture.jpg)

Y(1)= $75,000

]

.pull-right[
![:scale 370px](pics/UNTPicture.jpg)

Y(0)= $60,000
]

--
&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='black' size=1px width=1100px&gt;&lt;/html&gt;
Treatment effect =Y(1)-Y(0)= $15,000

---
# What is a "Potential Outcome"
.pull-left[
![:scale 420px](pics/EmoryPicture.jpg)

Y(1)= $75,000

]

.pull-right[
![:scale 370px](pics/UNTPicture.jpg)

Y(0)= ?
]

--
&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='black' size=1px width=1100px&gt;&lt;/html&gt;
Treatment effect =Y(1)-Y(0)= ?

---
# Do we ever observe the potential outcomes?
.center[
  ![:scale 700px](https://media.giphy.com/media/zZeCRfPyXi9UI/giphy.gif)
]

--
Without a time machine...hard to get *individual* treatment effects.

---
# *Average* Treatment Effect




&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot1-output-1.png" style="display: block; margin: auto;" /&gt;


---
# *Average* Treatment Effect


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot2-output-1.png" style="display: block; margin: auto;" /&gt;


---
# *Average* Treatment Effect

&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot3-output-1.png" style="display: block; margin: auto;" /&gt;


---
# *Average* Treatment Effect


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot4-output-1.png" style="display: block; margin: auto;" /&gt;

--
`$$ATE = E[Y(1)-Y(0)]$$`

&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: selection_observables

# Selection on Observables

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

---
# Average Treatment Effect
&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /&gt;

---
# ...with Selection


&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /&gt;

---
# ...with Selection


&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;


---
# ...with Selection


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot5-output-1.png" style="display: block; margin: auto;" /&gt;


---
# ...with Selection


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot6-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Assumption 1: Selection on Observables


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot7-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Assumption 1: Selection on Observables


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot8-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Assumption 1: Selection on Observables

More formally:&lt;br&gt;
`\(E[Y(1)|W,shape]=E[Y(1)|shape]\)`&lt;br&gt;
`\(Y(1),Y(0) \perp\!\!\!\perp W | shape\)`&lt;br&gt;

--
In words...nothing unobserved that determines treatment selection and affects your outcome of interest.

---
# Violation of Selection on Observables


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-select-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Violation of Selection on Observables


&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot9-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Assumption 2: Common Support
Someone of each type must be in both the treated and untreated groups

--
`$$0 &lt; \text{Pr}(W=1|X) &lt;1$$`

---
# Assumption 2: Common Support
&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;

---
# Violation of Common Support


&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;

&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: methods

# Causal Inference with Observational Data

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;


---
# Fundamental Problem of Causal Inference

Potential outcomes:
- `\(Y_{i}(1)\)` for `\(W_{i}=1\)`
- `\(Y_{i}(0)\)` for `\(W_{i}=0\)`

--
Average treatment effect is `\(E[Y_{i}(1)-Y_{i}(0)]\)`, but: 
- `\(E[Y_{i}|W_{i}=1] \neq E[Y_{i}(1)]\)`
- `\(E[Y_{i}|W_{i}=0] \neq E[Y_{i}(0)]\)`

--
We don't observe the counterfactual outcome...what would have happened if a treated unit was actually untreated.


---
# Fundamental Problem of Causal Inference
*ALL* attempts at causal inference represent some attempt at estimating the counterfactual outcome. We need an estimate for `\(E[Y_{i}(0)]\)` among those that were treated, and vice versa for `\(E[Y_{i}(1)]\)`.


---
# Causal inference with observational data
Solution for now: find covariates `\(X_{i}\)` such that the following assumptions are plausible:

1. Selection on observables: `$$Y_{i}(1), Y_{i}(0) \perp\!\!\!\perp W_{i} | X_{i}$$`
2. Common support: `$$0 &lt; \text{Pr}(W_{i}=1|X_{i}) &lt; 1$$`

---
# Causal inference with observational data
With selection on observables and common support:
1. Matching estimators: `$$E[Y_{i}(1) - Y_{i}(0)] = E[ E[Y_{i}|W_{i}=1, X_{i}] - E[Y_{i}|W_{i}=0, X_{i}] ]$$`
2. Regression estimators: `$$E[Y_{i}(1) - Y_{i}(0)] = E[ E[Y_{i}|W_{i}=1, X_{i}] ] - E[ E[Y_{i}|W_{i}=0, X_{i}] ]$$`

--
&lt;br&gt;
What's the difference?

---
# Matching
&lt;img src="03-Selection-HospitalPricing_files/figure-html/ate-plot8-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Regression


&lt;img src="03-Selection-HospitalPricing_files/figure-html/regression-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Estimation options
- Matching
- Weighting
- Regression
- Doubly-robust weighting + regression (won't cover)


---
# Matching: The process
1. For each observation `\(i\)`, find the `\(m\)` "nearest" neighbors, `\(J_{m}(i)\)`. 
2. Impute `\(\hat{Y}_{i}(0)\)` and `\(\hat{Y}_{i}(1)\)` for each observation:&lt;br&gt;
$\hat{Y}_{i}(0) = \begin{cases}
    Y_{i} &amp; \text{if} &amp; W_{i}=0 \\
    \frac{1}{m} \sum_{j \in J_{m}(i)} Y_{j} &amp; \text{if} &amp; W_{i}=1 
\end{cases}$&lt;br&gt;

$\hat{Y}_{i}(1) = \begin{cases}
    Y_{i} &amp; \text{if} &amp; W_{i}=1 \\
    \frac{1}{m} \sum_{j \in J_{m}(i)} Y_{j} &amp; \text{if} &amp; W_{i}=0 
\end{cases}$

3. Form "matched" ATE:&lt;br&gt;
`\(\hat{\delta}^{\text{match}} = \frac{1}{N} \sum_{i=1}^{N} \left(\hat{Y}_{i}(1) - \hat{Y}_{i}(0) \right)\)`

---
# Matching: Defining "nearest"

1. Euclidean distance:&lt;br&gt;
`\(\sum_{k=1}^{K} (X_{ik} - X_{jk})^{2}\)`
2. Scaled Euclidean distance:&lt;br&gt;
`\(\frac{1}{\sigma_{X_{k}}^{2}} \sum_{k=1}^{K} (X_{ik} - X_{jk})^{2}\)`
3. Mahalanobis distance:&lt;br&gt;
`\((X_{i} - X_{j})' \Sigma_{X}^{-1} (X_{i} - X_{j})\)`

---
# Weighting

1. Estimate propensity score `ps &lt;- glm(W~X, family=binomial, data)`, denoted `\(\hat{\pi}(X_{i})\)`
2. Weight by inverse of propensity score&lt;br&gt;
.center[
`\(\hat{\mu}_{1} = \frac{ \sum_{i=1}^{N} \frac{Y_{i} W_{i}}{\hat{\pi}(X_{i})} }{ \sum_{i=1}^{N} \frac{W_{i}}{\hat{\pi}(X_{i})} }\)` and 
`\(\hat{\mu}_{0} = \frac{ \sum_{i=1}^{N} \frac{Y_{i} (1-W_{i})}{1-\hat{\pi}(X_{i})} }{ \sum_{i=1}^{N} \frac{1-W_{i}}{1-\hat{\pi}(X_{i})} }\)`
]
3. Form "inverse-propensity weighted" ATE:&lt;br&gt;
.center[
`\(\hat{\delta}^{IPW} = \hat{\mu}_{1} - \hat{\mu}_{0}\)`
]

---
# Regression
1. Regress `\(Y_{i}\)` on `\(X_{i}\)` among `\(W_{i}=1\)` to form `\(\hat{\mu}_{1}(X_{i})\)`
2. Regress `\(Y_{i}\)` on `\(X_{i}\)` among `\(W_{i}=0\)` to form `\(\hat{\mu}_{0}(X_{i})\)`
3. Form difference in predictions:&lt;br&gt;
.center[
`\(\hat{\delta}^{reg} = \frac{1}{N} \sum_{i=1}^{N} \left(\hat{\mu}_{1}(X_{i}) - \hat{\mu}_{0}(X_{i})\right)\)`
]

--
&lt;br&gt;
Or estimate in one step, 
.center[
`\(Y_{i} = \delta W_{i} + \beta X_{i} + W_{i} \times \left(X_{i} - \bar{X}\right) \gamma + \varepsilon_{i}\)`
]

&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: hcris

# Understanding HCRIS Data

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;


---
# What is HCRIS?
Healthcare Cost Report Information System ('cost reports')
- Nursing Homes (SNFs)
- Hospice
- Home Health Agencies
- Hospitals 

---
# Hospital Cost Reports

.center[
  ![:scale 800px](pics/HCRIS.png)
]

---
# The Data

Let's work with the [HCRIS GitHub repository](https://github.com/imccart/HCRIS). But forming the dataset is up to you this time.

--
.center[
  ![:scale 700px](https://media.giphy.com/media/26DNdV3b6dqn1jzR6/giphy.gif)
]


---
# The Data



```r
hcris.data %&gt;% 
  ggplot(aes(x=as.factor(year))) + 
  geom_bar() +
  labs(
    x="Year",
    y="Number of Hospitals",
    title="Number of Hospitals per Year"
  ) + theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust=1))
```
.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/hospital-count-callout-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Number of hospitals

&lt;img src="03-Selection-HospitalPricing_files/figure-html/hospital-count-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Estimating hospital prices

```r
hcris.data &lt;- hcris.data %&gt;%
  mutate( discount_factor = 1-tot_discounts/tot_charges,
          price_num = (ip_charges + icu_charges + ancillary_charges)*discount_factor - tot_mcare_payment,
          price_denom = tot_discharges - mcare_discharges,
          price = price_num/price_denom)
```

---
# Estimating hospital prices

.left-code[

```r
hcris.data %&gt;% group_by(year) %&gt;% 
  filter(price_denom&gt;10, !is.na(price_denom), 
         price_num&gt;0, !is.na(price_num)) %&gt;%  
  select(price, year) %&gt;% 
  summarize(mean_price=mean(price, na.rm=TRUE)) %&gt;%
  ggplot(aes(x=as.factor(year), y=mean_price)) + 
  geom_line(aes(group=1)) +
  labs(
    x="Year",
    y="Average Hospital Price",
    title="Hospital Prices per Year"
  ) + scale_y_continuous(labels=comma) +
  theme_bw() + theme(axis.text.x = element_text(angle = 90, hjust=1))
```
]

.right-plot[
![](03-Selection-HospitalPricing_files/figure-html/price-plot1-1.png)
]


---
# Estimating hospital prices

.left-code[

```r
hcris.data %&gt;% group_by(year) %&gt;% 
  filter(price_denom&gt;100, !is.na(price_denom), 
         price_num&gt;0, !is.na(price_num),
*        price&lt;100000) %&gt;%
  select(price, year) %&gt;% 
  summarize(mean_price=mean(price, na.rm=TRUE)) %&gt;%
  ggplot(aes(x=as.factor(year), y=mean_price)) + 
  geom_line(aes(group=1)) +
  labs(
    x="Year",
    y="Average Hospital Price",
    title="Hospital Prices per Year"
  ) + scale_y_continuous(labels=comma) +
  theme_bw() + theme(axis.text.x = element_text(angle = 90, hjust=1))
```
]

.right-plot[
![](03-Selection-HospitalPricing_files/figure-html/price-plot2-1.png)
]


&lt;!-- New Section --&gt;
---
class: inverse, center, middle
name: price_pfp

# Pricing and Pay for Performance

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;


---
# Penalized hospitals

```r
final.hcris &lt;- hcris.data %&gt;% ungroup() %&gt;%
  filter(price_denom&gt;100, !is.na(price_denom), 
         price_num&gt;0, !is.na(price_num),
         price&lt;100000, 
*        beds&gt;30, year==2012) %&gt;%
  mutate( hvbp_payment = ifelse(is.na(hvbp_payment),0,hvbp_payment),
*         hrrp_payment = ifelse(is.na(hrrp_payment),0,abs(hrrp_payment)),
*   penalty = (hvbp_payment-hrrp_payment&lt;0))
```



---
# Effects of being penalized
- Mean price among penalized hospitals: 9,896.31
- Mean price among non-penalized hospitals: 9,560.41
- Mean difference: 335.9

---
# Comparison of hospitals
Are penalized hospitals sufficiently similar to non-penalized hospitals?

--
Let's look at covariate balance using a love plot, part of the `library(cobalt)` package.

---
# Love plots without adjustment


```r
lp.vars &lt;- final.hcris %&gt;% 
  select(beds, mcaid_discharges, penalty, ip_charges, 
         mcare_discharges, tot_mcare_payment, price) %&gt;%
  filter(complete.cases(.))
lp.covs &lt;- lp.vars %&gt;% select(-c("penalty","price"))
love.plot(bal.tab(lp.covs,treat=lp.vars$penalty), colors="black", shapes="circle", threshold=0.1) + 
  theme_bw() + theme(legend.position="none")
```
.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/cov-balance-callout-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Love plots without adjustment

&lt;img src="03-Selection-HospitalPricing_files/figure-html/cov-balance-output-1.png" style="display: block; margin: auto;" /&gt;

---
# Using matching to improve balance
Some things to think about:
- exact versus nearest neighbor
- with or without ties (and how to break ties)
- measure of distance

---
# 1. Exact Matching

```r
m.exact &lt;- Matching::Match(Y=lp.vars$price,
                           Tr=lp.vars$penalty,
                           X=lp.covs,
                           M=1,
*                          exact=TRUE)
print(m.exact)
```

```
## [1] NA
## attr(,"class")
## [1] "Match"
```

---
# 1. Exact Matching (on a subset)

```r
lp.covs2 &lt;- lp.covs %&gt;% select(beds, mcaid_discharges)
m.exact &lt;- Matching::Match(Y=lp.vars$price,
                           Tr=lp.vars$penalty,
                           X=lp.covs2,
                           M=1,
                           exact=TRUE,
*                          estimand="ATE")
```

---
# 1. Exact Matching (on a subset)

```r
love.plot(bal.tab(m.exact, covs = lp.covs2, treat = lp.vars$penalty),  
          threshold=0.1, 
          grid=FALSE, sample.names=c("Unmatched", "Matched"),
          position="top", shapes=c("circle","triangle"),
          colors=c("black","blue")) + 
  theme_bw()
```

.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-exact-callout-1.png" style="display: block; margin: auto;" /&gt;
]


---
# 1. Exact Matching (on a subset)

&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-exact-output-1.png" style="display: block; margin: auto;" /&gt;


---
# 2. Nearest neighbor matching (inverse variance)

```r
m.nn.var &lt;- Matching::Match(Y=lp.vars$price,
                            Tr=lp.vars$penalty,
                            X=lp.covs,
                            M=4,
                            Weight=1,
                            estimand="ATE")

v.name=data.frame(new=c("Beds","Medicaid Discharges", "Inaptient Charges",
                   "Medicare Discharges", "Medicare Payments"))
```

---
# 2. Nearest neighbor matching (inverse variance)


```r
love.plot(bal.tab(m.nn.var, covs = lp.covs, treat = lp.vars$penalty), 
          threshold=0.1, 
          var.names=v.name,
          grid=FALSE, sample.names=c("Unmatched", "Matched"),
          position="top", shapes=c("circle","triangle"),
          colors=c("black","blue")) + 
  theme_bw()
```

.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-var-callout1-1.png" style="display: block; margin: auto;" /&gt;
]


---
# 2. Nearest neighbor matching (inverse variance)

&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-var-output1-1.png" style="display: block; margin: auto;" /&gt;




---
# 2. Nearest neighbor matching (inverse variance)

```r
m.nn.var2 &lt;- Matching::Match(Y=lp.vars$price,
                             Tr=lp.vars$penalty,
                             X=lp.covs,
                             M=1,
                             Weight=1,
                             estimand="ATE")
```

---
# 2. Nearest neighbor matching (inverse variance)


```r
love.plot(bal.tab(m.nn.var2, covs = lp.covs, treat = lp.vars$penalty), 
          threshold=0.1, 
          var.names=v.name,
          grid=FALSE, sample.names=c("Unmatched", "Matched"),
          position="top", shapes=c("circle","triangle"),
          colors=c("black","blue")) + 
  theme_bw()
```

.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-var-callout2-1.png" style="display: block; margin: auto;" /&gt;
]


---
# 2. Nearest neighbor matching (inverse variance)

&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-var-output2-1.png" style="display: block; margin: auto;" /&gt;


---
# 2. Nearest neighbor matching (Mahalanobis)

```r
m.nn.md &lt;- Matching::Match(Y=lp.vars$price,
                           Tr=lp.vars$penalty,
                           X=lp.covs,
                           M=1,
                           Weight=2,
                           estimand="ATE")                           
```

---
# 2. Nearest neighbor matching (Mahalanobis)


```r
love.plot(bal.tab(m.nn.md, covs = lp.covs, treat = lp.vars$penalty), 
          threshold=0.1, 
          var.names=v.name,
          grid=FALSE, sample.names=c("Unmatched", "Matched"),
          position="top", shapes=c("circle","triangle"),
          colors=c("black","blue")) + 
  theme_bw()
```

.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-md-callout1-1.png" style="display: block; margin: auto;" /&gt;
]


---
# 2. Nearest neighbor matching (Mahalanobis)

&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-md-output1-1.png" style="display: block; margin: auto;" /&gt;

---
# 2. Nearest neighbor matching (propensity score)

```r
logit.model &lt;- glm(penalty ~ beds + mcaid_discharges + ip_charges + mcare_discharges +
            tot_mcare_payment, family=binomial, data=lp.vars)
ps &lt;- fitted(logit.model)
m.nn.ps &lt;- Matching::Match(Y=lp.vars$price,
                           Tr=lp.vars$penalty,
                           X=ps,
                           M=1,
                           estimand="ATE")
```

---
# 2. Nearest neighbor matching (propensity score)


```r
love.plot(bal.tab(m.nn.ps, covs = lp.covs, treat = lp.vars$penalty), 
          threshold=0.1, 
          var.names=v.name,
          grid=FALSE, sample.names=c("Unmatched", "Matched"),
          position="top", shapes=c("circle","triangle"),
          colors=c("black","blue")) + 
  theme_bw()
```

.plot-callout[
&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-ps-callout-1.png" style="display: block; margin: auto;" /&gt;
]


---
# 2. Nearest neighbor matching (propensity score)

&lt;img src="03-Selection-HospitalPricing_files/figure-html/lp-ps-output-1.png" style="display: block; margin: auto;" /&gt;

---
# 3. Weighting
&lt;img src="03-Selection-HospitalPricing_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

---
# Different estimators
1. &lt;u&gt;Exact matching&lt;/u&gt;

```
## 
## Estimate...  1777.6 
## AI SE......  34.725 
## T-stat.....  51.191 
## p.val......  &lt; 2.22e-16 
## 
## Original number of observations..............  2707 
## Original number of treated obs...............  698 
## Matched number of observations...............  12 
## Matched number of observations  (unweighted).  12 
## 
## Number of obs dropped by 'exact' or 'caliper'  2695
```


---
# Different estimators
2. &lt;u&gt;Nearest neighbor&lt;/u&gt;

- Inverse variance

```
## 
## Estimate...  -526.95 
## AI SE......  223.06 
## T-stat.....  -2.3623 
## p.val......  0.01816 
## 
## Original number of observations..............  2707 
## Original number of treated obs...............  698 
## Matched number of observations...............  2707 
## Matched number of observations  (unweighted).  2711
```

---
# Different estimators
2. &lt;u&gt;Nearest neighbor&lt;/u&gt;
- Mahalanobis

```
## 
## Estimate...  -492.82 
## AI SE......  223.55 
## T-stat.....  -2.2046 
## p.val......  0.027485 
## 
## Original number of observations..............  2707 
## Original number of treated obs...............  698 
## Matched number of observations...............  2707 
## Matched number of observations  (unweighted).  2708
```

---
# Different estimators
2. &lt;u&gt;Nearest neighbor&lt;/u&gt;
- Propensity score

```
## 
## Estimate...  -201.03 
## AI SE......  275.76 
## T-stat.....  -0.72898 
## p.val......  0.46601 
## 
## Original number of observations..............  2707 
## Original number of treated obs...............  698 
## Matched number of observations...............  2707 
## Matched number of observations  (unweighted).  14795
```


---
# Different estimators
3. &lt;u&gt;IPW Weighting&lt;/u&gt;

```r
lp.vars &lt;- lp.vars %&gt;%
  mutate(ipw = case_when(
    penalty==1 ~ 1/ps,
    penalty==0 ~ 1/(1-ps),
    TRUE ~ NA_real_
  ))
mean.t1 &lt;- lp.vars %&gt;% filter(penalty==1) %&gt;%
  select(price, ipw) %&gt;% summarize(mean_p=weighted.mean(price,w=ipw))
mean.t0 &lt;- lp.vars %&gt;% filter(penalty==0) %&gt;%
  select(price, ipw) %&gt;% summarize(mean_p=weighted.mean(price,w=ipw))
mean.t1$mean_p - mean.t0$mean_p
```

```
## [1] -196.8922
```

---
# Different estimators
3. &lt;u&gt;IPW Weighting with Regression&lt;/u&gt;

```r
ipw.reg &lt;- lm(price ~ penalty, data=lp.vars, weights=ipw)
summary(ipw.reg)
```

```
## 
## Call:
## lm(formula = price ~ penalty, data = lp.vars, weights = ipw)
## 
## Weighted Residuals:
##    Min     1Q Median     3Q    Max 
## -18691  -4802  -1422   2651  94137 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9876.4      147.8  66.808   &lt;2e-16 ***
## penaltyTRUE   -196.9      211.2  -0.932    0.351    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7829 on 2705 degrees of freedom
## Multiple R-squared:  0.0003211,	Adjusted R-squared:  -4.85e-05 
## F-statistic: 0.8688 on 1 and 2705 DF,  p-value: 0.3514
```

---
# Different estimators
4. &lt;u&gt;Regression Only&lt;/u&gt;

```r
reg1.dat &lt;- lp.vars %&gt;% filter(penalty==1, complete.cases(.))
reg1 &lt;- lm(price ~ beds+ mcaid_discharges + ip_charges + mcare_discharges +
            tot_mcare_payment, data=reg1.dat)

reg0.dat &lt;- lp.vars %&gt;% filter(penalty==0, complete.cases(.))
reg0 &lt;- lm(price ~ beds + mcaid_discharges + ip_charges + mcare_discharges +
            tot_mcare_payment, data=reg0.dat)
pred1 &lt;- predict(reg1,new=lp.vars)
pred0 &lt;- predict(reg0,new=lp.vars)
mean(pred1-pred0)
```

```
## [1] -5.845761
```

---
# Different estimators
4. &lt;u&gt;Regression in one step&lt;/u&gt;

```r
reg.dat &lt;- lp.vars %&gt;% ungroup() %&gt;% filter(complete.cases(.)) %&gt;%
  mutate(beds_diff = penalty*(beds - mean(beds)),
         mcaid_diff = penalty*(mcaid_discharges - mean(mcaid_discharges)),
         ip_diff = penalty*(ip_charges - mean(ip_charges)),
         mcare_diff = penalty*(mcare_discharges - mean(mcare_discharges)),
         mpay_diff = penalty*(tot_mcare_payment - mean(tot_mcare_payment)))
reg &lt;- lm(price ~ penalty + beds + mcaid_discharges + ip_charges + mcare_discharges + tot_mcare_payment + 
            beds_diff + mcaid_diff + ip_diff + mcare_diff + mpay_diff,
          data=reg.dat)
summary(reg)
```

```
## 
## Call:
## lm(formula = price ~ penalty + beds + mcaid_discharges + ip_charges + 
##     mcare_discharges + tot_mcare_payment + beds_diff + mcaid_diff + 
##     ip_diff + mcare_diff + mpay_diff, data = reg.dat)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -38175  -2900   -597   2105  67409 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        8.466e+03  1.711e+02  49.482  &lt; 2e-16 ***
## penaltyTRUE       -5.846e+00  2.124e+02  -0.028  0.97804    
## beds               1.107e+00  1.421e+00   0.779  0.43618    
## mcaid_discharges  -4.714e-01  7.296e-02  -6.462 1.23e-10 ***
## ip_charges         6.426e-06  1.285e-06   5.002 6.04e-07 ***
## mcare_discharges  -8.122e-01  9.257e-02  -8.774  &lt; 2e-16 ***
## tot_mcare_payment  9.502e-05  6.858e-06  13.857  &lt; 2e-16 ***
## beds_diff          2.517e+00  2.986e+00   0.843  0.39931    
## mcaid_diff         1.058e-01  1.570e-01   0.674  0.50050    
## ip_diff           -4.534e-06  2.027e-06  -2.237  0.02539 *  
## mcare_diff         4.806e-01  1.809e-01   2.657  0.00793 ** 
## mpay_diff         -5.452e-05  1.321e-05  -4.128 3.78e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4728 on 2695 degrees of freedom
## Multiple R-squared:  0.2477,	Adjusted R-squared:  0.2447 
## F-statistic: 80.69 on 11 and 2695 DF,  p-value: &lt; 2.2e-16
```

---
# Different estimators
4. &lt;u&gt;Regression in one step&lt;/u&gt;

```
## 
## Call:
## lm(formula = price ~ penalty + beds + mcaid_discharges + ip_charges + 
##     mcare_discharges + tot_mcare_payment + beds_diff + mcaid_diff + 
##     ip_diff + mcare_diff + mpay_diff, data = reg.dat)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -38175  -2900   -597   2105  67409 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        8.466e+03  1.711e+02  49.482  &lt; 2e-16 ***
## penaltyTRUE       -5.846e+00  2.124e+02  -0.028  0.97804    
## beds               1.107e+00  1.421e+00   0.779  0.43618    
## mcaid_discharges  -4.714e-01  7.296e-02  -6.462 1.23e-10 ***
## ip_charges         6.426e-06  1.285e-06   5.002 6.04e-07 ***
## mcare_discharges  -8.122e-01  9.257e-02  -8.774  &lt; 2e-16 ***
## tot_mcare_payment  9.502e-05  6.858e-06  13.857  &lt; 2e-16 ***
## beds_diff          2.517e+00  2.986e+00   0.843  0.39931    
## mcaid_diff         1.058e-01  1.570e-01   0.674  0.50050    
## ip_diff           -4.534e-06  2.027e-06  -2.237  0.02539 *  
## mcare_diff         4.806e-01  1.809e-01   2.657  0.00793 ** 
## mpay_diff         -5.452e-05  1.321e-05  -4.128 3.78e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4728 on 2695 degrees of freedom
## Multiple R-squared:  0.2477,	Adjusted R-squared:  0.2447 
## F-statistic: 80.69 on 11 and 2695 DF,  p-value: &lt; 2.2e-16
```


---
# Summary of ATEs
1. Exact matching: 1777.63
2. NN matching, inverse variance: -526.95
3. NN matching, mahalanobis: -492.82
4. NN matching, pscore: -201.03
5. Inverse pscore weighting: -196.89
6. IPW regression: -196.89
7. Regression: 1019.74, 1156.39, 1423.34, 647.03, 705.12, 705.88, 765.05, 1051.2, 583.98, 463.74, 931.38, 603.83, 661.39, -3337.53, 453.71, 785.85, 724, 833.66, -131.87, 482.3, 456.21, 979.84, 871.42, 441.87, 713.78, 873.89, 798.58, 450.64, 1077.72, 586.36, 525.8, 527.04, 903.09, 635.18, 854.19, 994.9, 662.5, 31.01, 848.66, 667.87, 699.37, 12.61, 269.94, 549.11, 379.83, 876.35, 1541.67, 774.74, 660.19, 589.27, 618.9, 566.03, 468.38, 639.9, 760.14, 861.31, 556.53, 557.49, 963.17, 482.16, 601.33, 682.71, 710.02, 835.66, 287.88, -1344.45, 103.9, 301.22, -190.88, -210.31, 197.37, 739.2, -1513.14, -36.54, -218.32, 820.18, 717.9, 134.69, 293.31, 296.84, 747.84, -126.93, -1663.46, -884.47, -279.58, 274.07, -144.88, 467.63, -95.72, 306.92, 396.21, 515.54, 236.81, -1542.55, 1295.93, 414.7, 451.01, 678.46, 106.62, 746.95, 1186.9, 431.12, 1091.56, 279.01, 333.94, -2366.66, -213.31, 364.83, 529.46, 587.7, 584.11, 476.6, 477.54, 263.12, 286.22, 556.38, 204.9, 403.93, 356.44, 523.33, 540.79, 387.87, 64.16, 562.53, 1554.99, 493.36, -1255.89, 777.97, 639.23, 556.2, 466.65, 659.06, 570.39, 890.66, 747.99, 810.53, 830.64, 815, 561.05, 616.89, 592.41, 711.14, 833.12, 517.64, 754.15, 673.88, 536.15, 486.62, 765.85, 774.67, 674.38, 498.21, 578.79, 378.32, 474.25, 533.77, -1000.03, -475.82, -1284.74, -229.28, -1344.77, -1170.93, 222.07, 223.76, -2402.69, 186.71, -1471.02, -23.91, -4579.11, -1630.73, 439.31, 140.23, -596.66, -1642.39, -1167.23, 352.15, -3133.11, 247.4, 365.64, -5105.95, 278.8, -273.98, -506.25, -1070.11, -1276.61, -1964.35, -539.75, 311.75, -1184.65, -3425.56, 98.68, -485.58, -707.55, -2487.26, 284.88, 242.96, 435.71, -1471.18, -291.07, -1884.64, -252.77, -149.93, -1843.08, -217.07, -329.44, -4658.83, 378.72, 405, -2072.34, 340.18, -363.66, -1087.22, 142.69, -102.67, -476.68, 387.7, -3432.22, -125.32, 185.29, -121.85, -709.2, 72.02, -499.68, -267.26, 347.25, 109.17, -2297.58, 474.3, 218.29, -822.52, -2161.1, 329.55, -316.42, -282.49, -373.84, -1033.51, -1886.95, -201.46, 385.48, -214.43, -194.09, -2762.31, -101.4, 446.69, 71.52, -1149.72, -1484.88, 17.91, -715.59, -2522.31, -240.97, -1536.2, -12.88, 259, -1995.48, 111.56, -760.39, -2479.29, -1540.64, -276.32, 497.04, -328.51, -306.58, 473.16, 161.95, -1.026468\times 10^{4}, 118.63, -69.21, 576.05, -1863.16, 380.38, -1849.08, -219.53, -960.89, -1371.35, -795.06, -752.62, 383.31, -446.11, 336.51, 287.23, -528.54, 89.62, -1874.64, -2681.85, -749.96, 112.91, 189.97, -274.98, -1642.17, -3778.34, 324.53, -1660.33, -364.28, -662.95, 382.82, -4144.59, 181.16, -942.96, 170.69, -702.28, 335.59, 266.52, -1544.28, -1180.9, 442.87, -1684.47, -237.32, 205.53, 347.7, -379.64, -125.35, -936.8, 209.25, 135.33, 247.66, 380.42, -1781.76, -175.6, 386.45, 320.28, -1753.33, -1.500539\times 10^{4}, -1037.29, 487.29, -1.204056\times 10^{4}, -724.98, -1289.52, -2070.69, -362.89, -1301.91, -1917.25, -1291.45, 125.15, -2093.91, 148.77, -1896.09, -386.51, -30.35, -1899.84, 324.79, -640.07, 235.42, 165.08, 487.12, 46.05, 183.74, -982.02, -1409.59, -692.37, 610.15, -1024.96, -1494.44, 155.43, 190, -10.83, 186.61, 282.85, 404.7, -491.17, 307.85, -8505.79, -171.99, 408.82, 203.89, -437.63, -1.596899\times 10^{4}, 192.66, 100.06, 166.4, 446.83, -419.88, -98.06, 360.67, -237.26, -48.51, -4589.56, 404.86, -60.61, 24.02, -249.56, 355.01, -111.62, 161.37, 192.94, -1411.12, 169.28, -2191.22, 6.08, -473.65, 345.32, 327.2, 211.85, 441.13, 55.83, 33.06, -2.05, 349.25, -1445.12, 330.47, -647.94, 506.27, -510.47, 116.49, 162.49, 418.81, 537.26, 435.07, 452.81, 162.59, 465.15, 150.92, 333.13, 90.8, -660.85, -44.21, 429.41, 391, 780.88, -467.89, -3573.45, -249.58, 474.3, 741.38, 94.67, -359.16, 525.23, 390.47, 199.56, 343.6, -282.48, 264.82, 517.54, 166.47, 307.4, 158.35, 330.45, 507.74, 44.12, 60.76, 452.77, 288.79, -283.8, 309.55, 230.89, -2545.91, -2575.42, 570.06, 324.07, -502.32, -638.22, 743.41, 448.37, -1394.94, 428.5, 424.3, 423.33, -267, -55.25, 384.24, -65.34, -8591.64, 244.8, -5236.14, 291.74, -1166.17, 473.99, 74.01, -814.59, -193.72, -22.54, -1134.04, -1704.1, 204.57, -241.03, 621.98, -1284.34, -546.62, -2535.64, 442.49, 148.34, 403.68, -6103.12, -248.25, 673.26, -663.8, -2679.84, -906.46, -1590.9, 585.12, 517.63, 501.17, 1316.7, 357.98, -2500.26, 754.06, 1119.3, 857.22, 1416.01, 626.29, 126.94, -2030.52, 524.95, 778.38, 789.89, 14.66, 688.3, 621.47, 679.73, 538.07, 768.78, 698.95, 587.52, 1359.94, 614.65, 480.76, 623.22, 812.04, 710.27, 748.24, 955.68, 751.71, 171.44, 698.01, 904.89, 607.36, 842.15, 1986.31, 406.77, 257.63, -164.17, 481.45, 487.42, 540.43, 366.52, 710.83, 535.21, 732.11, 792.12, 729.69, 458.65, 796.03, 627.7, -5520.26, 214.5, 503.5, 869.29, 810.02, 327.24, 943.39, 588.64, -3840.26, 483.16, 657.55, 672.33, 676.23, 870.58, 652.98, 534.27, -2320.24, 464.78, 473.3, 1842.33, 743.92, 402.28, 740.85, 486.8, 599.63, 540.34, 180.32, 690.99, 191.5, 662.61, -446.55, 375.64, -143.35, 462.13, 919.68, 557.3, 719.72, 674.06, 371.37, 1017.57, 966.63, 761.94, 552.49, 598.51, 948.57, 833.89, 568.13, 780.31, 1161.72, 706.02, 496.15, 603.57, 353.55, 433, 686.91, 953.67, 1062.37, 362.06, 184.65, 766.25, 511.51, 528.65, 592, 712.15, 806.33, 593.31, 683.93, 686.01, 618.7, 1110.75, 684.64, 782.3, 534.99, 511.8, 842.33, 306.69, 268.29, 515.83, -189.25, 883.71, 715.34, -29.42, 1284.05, 460.26, 361.03, 606.9, 553.92, 539.62, 180.48, 303.9, 698.69, 738.96, 578.78, 567.24, 453.43, 412.54, 275.86, 348.35, -4386.23, 428.89, 425.47, 916.29, 651.96, 460.7, 558.26, 321.47, 473.13, 491.9, -156.32, 455.19, 740.92, 572.19, -1476.53, 128, -250.49, 481.7, 613.79, 490.09, 456.78, 456.76, 183.6, 466.95, 537.87, 476.94, 270.41, 491.81, 720.46, 944.91, 539.11, 296.34, 672.28, 898.07, -1642.92, -213.98, 153.03, -1177.32, 459.33, 1022.08, 806.04, 763.79, 466.12, 513.47, 447.19, 615.97, 482.79, -648.17, 497.59, 267.59, 461.64, 721.11, 660.57, 657.92, 634.26, 1015.88, 579.34, 452.76, 397.66, 328.54, 518.01, 462.66, 441.46, 526.09, 300.87, 537.26, 375.69, -126.61, 496.39, 564.91, 681.81, 430.2, 466.61, 509.36, 513.32, 689.88, 231.25, 482.58, 427.98, 493.71, 660.19, 414.28, 563.43, 609.64, 515.52, -500.77, 216.18, 59.34, 56.21, -211.46, 147.66, 168.38, -366.63, -267.38, 245.18, 608.67, 97.09, 294.24, 59.5, 808.37, 581.16, 413.23, 590.87, -151.62, 316.47, 720.05, 373.37, -916.74, 668.76, 520.37, 399.84, 408.93, 535.39, 428.6, 261.08, 826.69, 545.62, 606.49, 590.98, 471.32, -133.63, -165.95, 628.29, -430.09, -145.95, 512.07, 558.3, 393.64, 408.7, -1306.01, 631.84, -237.07, -322.94, 771.92, 666.4, -4890.63, 545.83, -641.93, 699.79, 568.04, 705.54, 554.08, 559.92, -237.31, 749.97, 463.87, 615.42, -4923.07, 669.22, 523.46, 804.6, 754.9, 619.04, 807.31, 1274.4, 616.32, 467.15, 562.37, -715.67, -2213.27, 720.68, 547.32, -171.01, 369.96, 424.03, 761.58, 228.48, 425.3, 503.77, 729.61, 652.75, 637.65, -429.96, 537.55, 752.76, 412.39, 564.09, 729.64, -738.79, 868.01, 15.19, 152.08, 669.24, -3619.35, 159.95, 535.18, 1160.11, 162.33, -1296.15, 39.53, 749.93, 447, 159.29, 511.75, 133.08, -345.56, 525.71, 421.98, 705.97, 50.26, 714.34, -2958.94, 929.67, 531.66, 234.33, 681.4, 719.73, 228.77, 516.36, 429.61, 602.69, 460.84, 423.93, 355.64, 592.97, 519.82, 457.98, 414.34, 851.97, 556.52, 593.71, 749.31, 467.44, 652.54, 520.36, 442.45, 398.66, 30.48, 627.21, 512.32, 615.29, 618.09, 472.75, 533.95, 849.24, 526.82, 666.87, 436.81, 46.87, 309.37, -7949.29, 383.84, 491.14, 415.68, 537.4, 482.77, 504.07, 623.13, 460.8, 545.19, 1549.56, -1224.86, 519.21, 987.2, -2.48, 515.31, 506.3, 934.01, 459.27, 495.23, -9.25, 448.86, 583.02, 615.74, 753.02, 852.03, 476.84, 341.73, 613.34, 551.18, 578.02, 47.72, 426.04, 615.07, 324.23, 367.77, 524.52, 365.24, 296.83, 475.12, 205.51, 615.82, 456.2, 494.4, 396.64, 433.79, 384.24, 826.56, 656.89, 553.94, 519.24, 430.46, 396.88, 623.44, 558.78, 559.29, -2982.96, 684.02, 706.06, 570.72, -372.09, -711.96, 528.75, 716.85, 378.18, 565.51, 706.58, 417.99, 488.06, 453.52, 432.2, 475.03, 538.22, 448.31, 305.67, -207.57, 428.32, 694.52, 398.54, 240.37, 281.97, 295.92, -2973.2, 687.49, 429.29, 445.01, 460.57, 428.32, 476.72, 681.55, 414.12, 380.74, -406.81, 592.33, 495.34, 408.6, 476.08, 561.26, 540.09, 439.2, 523.82, 541.11, 452.1, 531.17, 175.7, 415.45, 439.61, 634.63, 810.5, 641.29, 912.01, 970.55, -214.11, 290.75, 1002.81, 795.77, 395.87, 525.93, 509.53, 631.65, 743.56, 790.63, 529.29, 385.34, 961.65, 859.63, 62.68, 630.7, 1120.91, 451.33, 557.55, 410.89, 604.79, 503.29, 768.02, 782.97, 510.41, 859.49, 424.67, 588.17, -3860.69, 703.78, 571.18, 507.53, 526.94, 1127.09, 608.69, -1578.2, 550.46, 754.72, 533.42, 533.41, 844.17, 488, 1208.03, 523.73, 721.98, 478.31, 750.44, 598.11, 671.96, 951.53, 740.49, 600.26, 710.4, -931.09, 458.09, 503.11, 1007.19, 417.41, 676.91, 710.13, 721.36, 572.53, 858.76, 645.87, 728.07, 797.95, 790.1, 666.83, 708.04, -240.91, 571.63, 451.14, -3044.52, 893.16, 802.46, 1620.82, 755.6, 580.08, 566.84, 579.59, 686.37, 695.87, 643.84, 249.92, 412.53, 795.77, 484.63, 542.16, 630.58, 568.45, 418.14, 481.5, 1170.84, 557.1, 624.24, 549.66, 1195.2, 1094.6, 450.72, 508.72, 778.63, 706.55, 423.18, 823.17, 703.44, 657.29, -1041.78, -218.37, 730.09, 651.93, 709.97, 602.19, 491.8, 927.35, 550.93, 306.91, 343.69, 350.36, 605.01, 300.89, 513.52, -1944.11, 410.56, 666.27, 550.41, 622.43, 271.05, 452.85, 495.04, -498.67, 495.95, 379.65, 649.64, 515.1, 359.31, 436.31, 354.08, 445.91, 629.19, -1.028229\times 10^{4}, -123.96, 1185.15, 638.82, -808.71, -280.09, -9507.94, -1100.89, -3154.44, 146.94, 1106.52, -936.68, 906.98, 1002.45, -903.33, -1024.62, -848.73, -1390.09, 952.81, -1945.44, 57.04, 286.28, 110.06, -356.57, -415.99, -160.74, -1039.83, -1240.69, 59.47, 650.28, -393.76, 1072.89, 744.06, 5.53, -303.85, 393.17, -14.6, 224.2, 424.71, -39.73, 98.11, -1229.19, 392.62, 145.8, 600.9, 408.6, 562.15, 420.81, -2863.97, 725.23, -535.65, -1215.99, -745.67, 354.65, 376.98, 266.96, 470.03, 275.67, 478.54, -189.11, 641.68, 721.44, -1.162715\times 10^{4}, 335.01, 362.19, 335.59, 448.6, 431.28, -5599.63, 539.41, 443.54, 462.2, -166.7, 728.68, 419.89, -1.114296\times 10^{4}, 420.96, -3661.26, 128.76, -6141.99, -2876.99, 519.02, 509.95, -569.79, 166.56, 441.21, 120.23, 557.8, 318.44, 460.22, -1347.45, -1319.07, -1776.36, 358.45, 661.28, -1877.22, -1069.94, 722.57, 638.69, 393.33, 275.35, 449.31, -2206.28, 534.99, 425.06, -7832.74, -148.73, -5293.48, -105.55, 494.16, 452.18, -392, 572.29, 335.8, 492.32, 594.16, 476.94, -87.42, 566.68, 782.57, 399.3, 562.18, 438.12, -1121.31, 813.98, 422.6, 373.68, -2821.58, 230.5, 451.69, 428.58, -1156.77, 365.77, 511.8, -5101.12, -497.35, 367.72, -1242.9, 370.74, 371.06, -264.19, -1463.03, -1734.54, -135.43, 481.92, 274.77, 709.67, -176.27, -183.87, 380.25, 533.45, 378.5, 50.8, -27.74, -1598.89, 115.29, 359.43, 494.66, 238.96, 112.11, 466.84, 434.11, 233.28, -1387.69, 212.7, 422.35, 260.49, 289.96, -2032.71, 464.76, -6576.34, 363.31, 398.32, 243.15, -1416.02, -1241.78, 621.62, 519.26, 414.31, -53.29, 367.26, 547.95, 186.8, 524.75, -4097.8, -1995.92, -348.28, 434.55, 384.21, 401.24, 587.22, -473.13, -4107.8, 412.49, 108.32, 534.94, 324.99, 393.63, -2326.07, -930.02, 521.39, 20.74, 402.89, 408.49, 378.26, 128.72, 491.58, 417.6, -611.17, -63.91, 1394.02, 687.15, 727.9, 352.81, 730.9, 812.36, 507.85, 504.77, 847.45, 480.75, 1447.33, 688.42, 774.41, 1286.09, 580.97, 825.76, 909.72, 651.05, 850.04, 732.7, 814.08, 872.62, 459.64, 485.45, 695.73, 745.67, 675.59, 862.15, 1503.9, 1064.65, 617.89, 757.7, 541.17, 680.72, 182.69, 490.26, 669.67, 672.61, -239.18, 830.51, 607.14, 784.49, 316.58, 537.73, 210.98, 701.18, 544.12, 347.86, -7530.98, 498.17, 296.41, 352.74, 691.55, 497.3, 417.85, 410.84, 417.04, -659.69, 368.35, 650.18, 402.36, 1453.05, 568.56, 287.33, 335.66, -488.25, 700.39, 555.83, 709.43, 76.63, -1980.9, 279.34, 358.47, 700.44, 636.97, 1319.83, 268.98, -2104.74, -1648.68, 511.62, 362.15, 716.42, 553.86, 162.81, 988.22, 607.99, 582.35, -7.44, 224.85, 421.36, 555.68, 450.29, 412.6, 584.06, 423.05, 477.09, 573.57, 524.54, 284.16, 296.08, -3.38, 249.18, 379.38, 436.6, -496.22, 401.05, 437.35, 409.74, -144.92, -2237.68, 759.53, -201.87, 518.96, 173.27, 175.61, 96.36, 491.66, 573.85, 518.23, 475.06, 369.73, 178.43, 722.5, 183.05, 60.94, -1200.84, 230.76, 276.33, 375.08, 492.86, 252.66, -294.62, -919.18, 155.17, 321.73, -702.81, 402.16, -322.07, 13.6, 150.37, 427.62, 187.25, 311.25, 76.77, -2777.27, 170.44, 612.35, 605.27, 472.98, 523.48, 421.53, 437.76, 465.1, 471.39, -3.93, 93.56, -1.038341\times 10^{4}, -4497.43, -846.8, 173.4, -1251.08, -1116.12, -1673.27, 120.99, 593.96, -2724.6, -5938.01, -1849.62, -259.16, -7206.17, -626.26, -994.86, -510.31, -1365.7, -841.22, -272.73, -2217.37, -1055.96, -796.53, -623.66, -9699.86, -792.72, -708.12, 54.77, -998.58, -3259.11, -349.01, -2341.36, -306.68, -1747.07, -955.24, -390.91, -881.8, 170.96, 268.15, 196.39, -3357.19, 410.43, -2420.51, -4681.34, -2276.04, -1390.12, -3820.03, -230.25, -398.8, -293.41, -2786.2, 510, -1582.36, -1296.81, -835.16, -427.33, -548.91, -220.02, 129.43, 59.3, -112.1, -3181.93, -1034.97, -188.67, 465.2, 301.36, -159.74, 602.26, 236.23, 388.45, 334.16, 462.18, 453.2, 639.52, 551.31, 501.85, 620.41, 299.25, 485.09, 544.71, 720.64, 468.68, 433.41, 423.67, 646.3, 85.67, -3764.53, 72.62, 511.71, -1737.42, 647.67, -3147.61, -1491.08, -628.01, -1.831761\times 10^{4}, -1094.03, -1160.48, 534.85, -1500.66, 586.98, -480.38, -5706.87, 613.81, 474.07, -5919.02, -1821.11, -46.55, 533.91, -2.442281\times 10^{4}, 571.89, -691.72, 27.27, 593.56, 576.46, 50.17, 403.05, -670.92, 658.78, 289.99, 799.83, 639.16, 506.07, -3.535634\times 10^{4}, 429.76, -875.37, -1.176446\times 10^{4}, -229.56, 647.21, 536.76, -6296.41, -484.37, -1656.78, -1187.52, 518.72, 376.23, -606.11, -1021.92, -1193.05, 409.4, -171.24, 154.26, -770.47, -5365.5, 284.88, -33.6, -9640.09, 713.88, 419.73, 527.54, -31.99, -3987.03, -316.56, -139.81, -1590.25, -1.185921\times 10^{4}, -8592.47, -2243.58, 609.9, -930.06, 556.93, -204.7, -648.68, 333.24, -559.47, 513.73, 479.46, -8007.85, 542.04, 542.23, -1032.81, -1345.83, 444.37, 153.43, 184.57, 471.01, -224.54, -2023.88, 377.67, -4296.83, 806.25, -400.47, -2996.58, 89.29, -460.63, 311.96, -200.36, -58.01, -181.32, 458.05, -356.62, 552.65, 451.25, 592.96, -225.69, -3283.85, -1824.22, 208.87, -3963.2, 707.75, 180.09, -394.1, 243.85, -3834.43, -1315.54, -353.21, 96.26, 291.7, -6733.58, -182.97, -823.74, -1614.21, -144.69, 343.75, -200.58, 750.02, 1226.81, 732.71, 670.72, 815.55, 1657.71, 914.27, 894.58, 920.92, 964, 522.35, 633.11, 734.75, 793.96, -7056.82, 977.74, 455.9, 1060.47, -4773.95, 620.32, 930.25, -4068.08, 977.38, 349.27, 555.04, 644.6, 820.62, 757.43, 794.62, -288.95, 1829.52, 872.34, 185.03, 651.86, 666.49, 506.7, 801.07, 1975.42, 618.08, 433.72, 595.14, 669.74, -3400.94, 782.64, 1316.18, 792.47, 683.43, 633.85, 782.51, 1017.66, 456.05, 831.1, 330.76, 700.89, 546.15, -270.12, 452.17, 843.79, 696.68, 562.29, 1072.26, 848.33, 535.1, 620.51, 451.19, 490.6, 486.92, 809.56, 726, 549.89, 758.72, 720.68, -31.98, 422.44, -731.94, 54.51, 81.48, 144.51, 438.47, 370.93, -3004.74, -1854.08, 248.37, 552.89, 807.38, 786.32, 620.47, 476.68, -123.16, -1386.82, 440.36, -963.94, 582.37, 364.67, -52.53, 597.97, 457.62, 204.44, 692.66, -74.1, 424.35, 416.54, 1222.43, 539.45, 406, -1647.96, -1771.91, 873.57, 952.43, 456.96, 465.91, -863.05, 350.73, 543.2, 1086.5, -2249.79, 641.48, 380.3, 568.32, 320.32, 203.84, 86.13, 421.1, 649.52, -654.37, 592.49, 645.82, 438.53, -4113.86, 454.51, 438.95, 468.61, 622.11, 745.28, 470.43, 430.1, 759.64, 984.69, 470.36, -1421.39, 724.65, 441.15, 812.3, 426.02, 407.89, 688.97, 510.81, 550.23, -93.4, -1204.09, -4735, -89.12, 869.26, 485.72, 1184.3, 752.37, 405.43, 337.56, 383.76, -134.07, 982.8, 642.32, 270.07, 547.55, -1441.55, 511.55, 906.63, 514.94, 477.37, 588.73, -1.004251\times 10^{4}, 836.91, 390.11, 486.46, 434.19, 338.67, 473.65, 437.57, 962.45, 574.44, 1020.61, 1188.18, 533.79, 516.92, 442.73, 361.56, 534.49, 767.3, 461.47, 355.22, 380.86, 506.86, 481.34, 698.01, 634.48, 1274.33, 502.31, 944.24, 396.2, 565.32, 433.09, 567.35, 565.81, 636.98, 989.72, 715.39, -1358.22, 482.38, 993.3, 660.75, 106.37, 626.7, 752.02, 613.82, 638.54, 593.83, 616.89, 544.1, 377.89, 506.91, 1857.27, -106.18, 1043.76, 452.45, 623.11, 361.8, 960.86, 636.42, 670.54, 737.28, 293.91, 562.52, 500.51, 342.38, 336.93, -137.11, 335.96, 152.28, -3394.51, -673.79, -651.76, -569.27, 331.64, 687.2, 401.2, 495.72, 306.08, 365.28, 439.41, 223.89, -564.52, 247.93, 459.04, 121.52, -197.21, 420.41, 292.61, 326.95, 383.17, 255.22, -829.8, 769.7, 202.46, 442.5, 712.14, -2374.45, 455.96, 359.22, 351.76, 708.43, 755.72, 548.87, 130.54, -4844.74, -855.64, 815.74, 626.04, 725.3, 293.87, 609.07, 609.76, 570.23, 855.05, 549.97, -772.42, 405.37, -663.43, 670.1, -1435.01, -2766.46, 622.01, 566.24, 525.65, 434.15, -588.97, 552.84, -913.7, 462.62, 449.32, 656.41, 574.43, 424.59, -114.1, -423.55, 498.88, 698.59, 539.22, 872.76, 454.6, 463.55, -841.18, -6.23, 405.4, 763.66, 383.01, 463.72, -1.083798\times 10^{4}, 452.44, 600.93, -882.54, 475.42, 668.93, 803.25, 416.27, 797.07, 117.68, 55.66, -2297.65, 1121.8, -634.54, -3499.42, 1184.11, 474.37, 825.01, 396.76, 626.22, -200.76, 650.92, 522.83, 526.84, -18.48, 650.86, -9577.39, 692.79, -8307.52, 397.84, -2178.8, 383.47, 401.16, 679.93, 518.49, 621.65, -1716.39, 185.9, 522.21, 530.17, 132.69, 445.49, 401.76, 906.26, 517.96, 524.98, 464.32, -156.58, -1890.9, 526.4, -2007.01, 916.49, -1598.82, 333.12, 541.03, -2836.72, 100.72, -94.08, 583.37, 809.41, -4187.8, 97.85, 324.7, 925.73, 563.26, 750.41, 1216.61, 702.58, 571.26, 426.79, 1205.59, 1671.77, 1198.95, 845.09, 1228.91, 1502.58, 1191.52, 887.79, 1272.13, 940.64, 758.8, 829.07, 453.19, 758.93, 1191.21, 1048.02, 1577.31, 727.54, 974.93, 1461.28, 1822.2, 477.53, 891.52, 783.53, 602.77, 834.44, -41.51, -147.62, 572.5, 473.85, -3720.98, 404.27, -231.26, 894.45, 350.54, -202.83, 524.47, 510.75, -4049.2, 526.49, -431.18, 614.54, 599.77, 423.76, 522.06, -876.72, 639.72, 137.33, 421.7, 203.74, 515.96, 422.39, 823.74, 399.27, 436.93, 566.22, 680.62, 583.07, 923.61, 503.84, 611.91, 682.06, 288.54, 482.83, 501.02, 517.09, 823.21, 69.83, 403.12, 621.59, -1192.41, 495.69, 153.59, 478.45, 630.66, 442.5, 287.99, -199.56, 218.39, 791.52, 928.28, 495.74, 364.55, 458.67, 684.16, 547.36, 518.89, 468.63, 336.87, 461.93, 227.87, -359.89, 314.55, -321.51, 480.03, 987.46, 794.03, 279.54, 783.11, 1073.71, -762.07, 509.41, 805.6, 516, 758.17, 746.56, 743.7, 466.65, 461.87, 544.87, 682.3, 923.52, -4898.53, 569.32, -149.22, 564.75, 1150.82, 476.65, 874.01, 622.57, 621.95, 744.86, 566.79, 707.6, 974.19, 788.09, 550.91, -165.08, 607.48, 121.64, 470.44, 493.97, 1471.53, 1091.03, 571.96, 588.67, 644.78, 475.69, 599.44, 821.45, 473, 727.38, -262.4, 512.21, 582.98, 646.24, -43.77, 1109.81, 646.7, 832.92, 428.65, 218.31, 676.16, 1055.5, 745.94, 673.24, 413.67, 710.11, 575.38, 473.23, 512.04, 439.88, 721.09, 488.04, 637.14, 211.42, 266.5, 1952.64, -1535.91, -3473.1, 1164.78, 507.05, 588.5, 85.29, 618.04, 202.7, 1258.2, 765.67, 163.89, 466.29, -132.96, 545.44, 395.64, -839.5, -2383.07, 399.77, -914.22, 2341.02, 454.74, -3131.46, 663.33, 409.95, 318.54, 468.01, 448.8, -1280.66, 400.71, 533.56, 435.57, 566.68, 174.23, 406.62, 500.47, 115.12, 505.92, 115.97, 411.19, -255.56, 502.5, 433.58, 329.36, 295.17, -269.47, -276.37, 409, 386.43, 666.13, 520.46, 664.4, 488.02, 413.22, 386.91, 565.16, 526.95, 525.84, 419.07, -253.98, 454.43, 553.7, 604.82, -3121.56, 361.13, 921.03, 679.47, 573.92, 257.43, 665.57, -979.59, 425.77, 112, 365.61, 1348.19, 572.57, 91.89, 392.41, 703.36, 262.92, 1976.84, 500.64, 573.47, 420.73, 255.06, 616.36, 379.74, 942.79, 552.2, 422.21, 700.06, -5485.05, 409.13, 451.45, -1573.35, 687.63, 487.29, 394.36, 478.16, 143.71, 425.56, 376.43, -604.43, 655.21, -146.23, 422.44, 442.37, 427.48, 436.18, 511.2, 749.58, 397.64, 478.64, 274.23, 706.98, 439.75, 323.46, 483.53, 513.45, 760, 521.13, 371.52, 412.25, 556.59, -171.8, 1018.46, 446.58, 658, 375.87, 367.91, 82.96, -808.28, -13.33, 541.87, 607.31, 816.44, 694.83, 110.06, 601.64, 510.8, 789.81, -795.32, -841.89, 113.51, 524.16, 503.1, 516.91, -239.3, 524.24, 336.52, 630.33, 261.96, 532.25, 41.68, 337.11, 500.79, 492.24, 194.58, 448.08, 503.79, 684.25, 571.97, 63.89, 478.55, 268.09, 580.6, 464.47, 216.96, 1035.93, 453.63, 123.15, 313.78, 63.19, 404.8, 607.28, 512.2, 472.23, 391.04, 352.17, 473.12, 317.75, 263.71, 121.44, 439.15, 449.05, -120.83, 341.79, 334.51, 344.14, 145.38, 140.7, 354.4, 278.3, 458.13, 439.69, 419.36, -1883.15, -661.87, 481.26, 510.12, 428.27, 608.46, 417.86, -224.17, 484.38, 411.83, 384.79, 735.04, 362.78, 442.15, 252.26, 989.6, 484.77, 514.63, 171.81, -2449.81, 43.68, 317.17, 456.51, 205.23, 824.16, 617.42, 551.75, -2313.57, -5629.05, 463.99, 607.68, 520.17, 686.49, 373.3, 297.73, 550.79, -1000.84, -3710.48, 437.42, 804.86, 437.79, 676.55, 333.69, 695.69, 776.26, 571.9, 572.99, 693.8, 1064.4, 134.91, 100.03, 988.03, 695.7, 310.74, 1032.77, -2179.53, 796.88, 678.2, 132.05, 692.16, 1055.37, 988.67, 484.62, 523.22, 486.83, 563.2, 646.38, 575.23, 611.48, 680.53, 556.41, 305.95, 399.57, 533.55, 481.99, 492.1, 854.2, 630.69, 833.49, 581.34, 1344.12, 462.68, 499.53, 702.14, 579.62, 178.87, 507.68, 344.76, -115.62, 161.95, 368.04, -2032.88, 280.29, -3685.17, 634.19, 66.6, -313.74, 299.8, -394.99, 291.74, 299.06, -645.39, -1282.68, 258.02, -2081.57, -145.75, 455.96, 381.98, 815.47, 507.23, -490.74, 428.35, 118.95, 353.76, -288.08, 4.03, 587.05, -2304.2, -41.57, 351.02, -2424.21, 441.42, 306.43, 150.47, 348.41, 149.54, -1082.96, 631.27, 343.97, -817.96, 290.16, 308.57, 487.89, 391.54, 135.22, -1647.82, 700.71, 1697.39, 456.57, 966.4, 783.35, 692.31, 476.06, 940.83, 534.13, 835.89, 607.71, 658.42, 528.02, 1110.76, 579.51, 814, 567.1, 507.76, 313.44, 1010.05, 876.87, 1366.05, 781.23, 461.7, 634.36, 379.66, 534.25, 359.96, 216.4, 601.51, 379.94, 88.34, 545.38, 366.64, 790.35, 566.85, 469.84, 125.05, 510.89, 405.22, 446.06, 453.5, 417.09, 453.31, 503.84, 147.22, 161.39, 437.92, 507.17, 415.87, 467.73, 567.07, 127.82, 522.46, 264.93, 613.56, -468.46, -478.7, 524.02, -303.88, 442.81, 314.51, 441.31, -4958.06, 480.38, 488.38, 450.03, 381.04, 541.87, 470.96, -203.96, -3149.32, 808.11, 253.32, -2491.95, 412.15, 424.11, 428.06, 202.23, 72.65, 311.91, 418.04, 282.52, 495.64, 491.86, 487.95, 125.14, -479.1, 193.11, 306.49, 374.71, 508.63, -149.7, 603.59, 68.41, 366.13, 417.86, 14.15, 485.76, 357.22, 169.01, 387.06, 426.77, 424.9, -233.9, 10.23, 407.98, 272.22, 221.23, 343.8
8. Regression 1-step: -5.85
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
